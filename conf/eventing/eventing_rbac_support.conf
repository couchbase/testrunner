eventing.eventing_rbac_support.EventingRBACSupport:
    test_to_check_user_with_sufficient_privileges_can_create_read_update_delete_eventing_functions,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_to_check_user_with_insufficient_privileges_cannot_create_read_update_delete_eventing_functions,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[dst_bucket:_default]"}]"""
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_with_timers
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=2,services_init=kv:eventing-kv:eventing-index:n1ql,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default],query_insert[dst_bucket],query_update[dst_bucket],query_delete[dst_bucket]"}]""",handler_code=n1ql_op_with_timers
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=2,services_init=kv:eventing-kv:eventing-index:n1ql,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default],query_insert[dst_bucket],query_update[dst_bucket],query_delete[dst_bucket]"}]""",handler_code=n1ql_op_without_timers
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_with_cron_timers
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default],data_writer[src_bucket]"}]""",handler_code=source_bucket_mutation,source_bucket_mutation=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_curl_get,curl=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_curl_post,curl=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_curl_put,curl=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_curl_delete,curl=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=bucket_op_expired,is_expired=True
    test_to_ensure_user_with_sufficient_privileges_can_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",cancel_timer=True,handler_code=cancel_timer
    test_to_ensure_user_with_insufficient_privileges_cannot_perform_eventing_lifecycle_operations,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[dst_bucket:_default]"}]"""
    test_to_check_function_is_undeployed_when_owner_loses_privileges,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_to_check_function_is_undeployed_when_owner_loses_privileges,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",pause_resume=True
    test_to_check_function_is_undeployed_when_owner_is_deleted,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_to_check_function_is_undeployed_when_owner_is_deleted,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]""",pause_resume=True
    test_authorisation_failures_for_bucket_operations_and_n1ql_queries_if_role_is_deleted_when_handler_is_deployed,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],data_reader[dst_bucket],eventing_manage_functions[src_bucket:_default]"}]""",handler_code=advance_bucket_op_auth_failure
    test_authorisation_failures_for_bucket_operations_and_n1ql_queries_if_role_is_deleted_when_handler_is_deployed,nodes_init=2,services_init=kv:eventing-index:n1ql,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],data_reader[dst_bucket],eventing_manage_functions[src_bucket:_default],query_insert[dst_bucket],query_update[dst_bucket],query_delete[dst_bucket]"}]""",handler_code=n1ql_op_auth_failure
    test_to_ensure_user_with_sufficient_privileges_can_export_eventing_functions_and_vice_versa,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_eventing_operations_after_deletion_and_recreation_of_function_owner,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[src_bucket:_default]"}]"""
    test_function_scope_modification_after_function_creation,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,users="""[{"id": "john", "name": "john", "password": "asdasd", "roles": "data_reader[metadata],data_writer[metadata],data_writer[dst_bucket],data_dcp_reader[src_bucket],eventing_manage_functions[*]"}]""",global_function_scope=True
    test_same_function_name_in_different_function_scope,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True
    test_multiple_same_function_names_in_same_function_scope,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True
    # MB-50829
    test_dropping_function_scope_when_handler_is_deployed_or_paused,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True
    test_dropping_function_scope_when_handler_is_deployed_or_paused,nodes_init=1,services_init=kv:eventing,dataset=default,groups=simple,reset_services=True,skip_cleanup=True,pause_resume=True
